<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>pwr4exp: Power Analysis for Experimental Designs • pwr4exp</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="pwr4exp: Power Analysis for Experimental Designs">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pwr4exp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/pwr4exp.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/an-ethz/pwr4exp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>pwr4exp: Power Analysis for Experimental Designs</h1>
                        <h4 data-toc-skip class="author">R Package
Version 1.0.0</h4>
            
            <h4 data-toc-skip class="date">2025-03-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/an-ethz/pwr4exp/blob/v1.0.0/vignettes/pwr4exp.Rmd" class="external-link"><code>vignettes/pwr4exp.Rmd</code></a></small>
      <div class="d-none name"><code>pwr4exp.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>pwr4exp</strong> is an R package for performing statistical
power analysis for experiments analyzed using linear mixed models (LMM).
It supports power calculations for omnibus F-tests (ANOVA-like tests)
and specific contrasts (t-tests) for Gaussian response variables,
employing the Satterthwaite approximation for degrees of freedom.</p>
<p><strong>Key features:</strong></p>
<ul>
<li>
<strong>Consistency:</strong> Specify the model formula to ensure
consistency between power analysis and data analysis.</li>
<li>
<strong>Flexibility:</strong> Support a variety of experimental
designs through either the general-purpose function
(<code>mkdesign</code>) or specialized functions (e.g.,
<code>designCRD</code>, <code>designRCBD</code>, <code>designLSD</code>,
<code>designCOD</code>, <code>designSPD</code>) for standard
designs.</li>
<li>
<strong>Correlation structures:</strong> Allow specification of
various residual variance-covariance structures, which is essential for
analyzing repeated measures, spatial, or other correlated data.</li>
</ul>
<p>The workflow involves two main steps:</p>
<ol style="list-style-type: decimal">
<li><p><a href="#design">Creating a design object</a>: Defining the
experimental structure and specifying parameters (fixed effects,
(co-)variances).</p></li>
<li><p><a href="#power">Calculating power</a>: Computing the power of
F-tests or t-tests for the effects of interest.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="design">Creating a design object<a class="anchor" aria-label="anchor" href="#design"></a>
</h2>
<p>A design object in <strong>pwr4exp</strong> is a <code>list</code>
containing design matrices, fixed effects, variance-covariance
components, and other higher-level parameters created by the
design-generating functions. It is not an experimental design in the
traditional sense, where randomization and unit allocation are
performed, but rather a container for all the information necessary to
conduct power analysis.</p>
<p>Two approaches are provided to define a design:</p>
<ul>
<li>
<a href="#mkdesign"><strong>General approach with
<code>mkdesign</code>:</strong></a> A design object can be created by
providing a model formula and a data frame that outlines the
experimental layout.</li>
<li>
<a href="#standard_design"><strong>Standard designs with Specific
Functions:</strong></a> Functions such as <code>designCRD</code>,
<code>designRCBD</code>, <code>designLSD</code>, <code>designCOD</code>,
or <code>designSPD</code> generate design objects for common
experimental setups. These functions allow specification of design
characteristics (e.g., number of treatments, blocks, or replicates) and
automatically handle the creation of the data frame.</li>
</ul>
<div class="section level3">
<h3 id="mkdesign">The <code>mkdesign</code> function<a class="anchor" aria-label="anchor" href="#mkdesign"></a>
</h3>
<p>The function <code>mkdesign</code> is versatile for designs as long
as the data frame is provided.</p>
<p><strong>Usage</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mkdesign.html">mkdesign</a></span><span class="op">(</span></span>
<span>  <span class="va">formula</span>, <span class="va">data</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">NULL</span>, means <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vcomp <span class="op">=</span> <span class="cn">NULL</span>, sigma2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  correlation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  template <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong></p>
<ul>
<li><p><strong><code>formula</code>:</strong> A right-hand-side model
formula that defines fixed and random effects. (Use
<code>lme4::lmer</code> syntax for specifying random effects.)</p></li>
<li><p><strong><code>data</code>:</strong> A data frame containing all
independent variables required by the model, consistent with the
design’s structure.</p></li>
<li><p><strong><code>means</code></strong> or <strong>beta:</strong>
Expected fixed effects. Either a vector of model coefficients
(<code>beta</code>) or expected means (<code>means</code>) must be
provided. <a href="#fixeff_template">Templates</a> for parameter
ordering can be generated by setting
<code>template = TRUE</code>.</p></li>
<li><p><strong><code>vcomp</code>:</strong> Variance components for any
random effects present in the model, provided as a numeric vector. A <a href="#vcomp_template">template</a> for input ordering can be generated
by setting <code>template = TRUE</code>.</p></li>
<li><p><strong><code>sigma2</code>:</strong> The residual
variance.</p></li>
<li><p><strong><code>correlation</code>:</strong> (Optional) A
correlation structure (<code><a href="https://rdrr.io/pkg/nlme/man/corClasses.html" class="external-link">nlme::corClasses</a></code>) for repeated
measures.</p></li>
<li><p><a href="#template"><strong><code>template</code>:</strong></a>
When set to <code>TRUE</code> or when only the <code>formula</code> and
<code>data</code> arguments are provided, templates for
<code>beta</code>, <code>means</code>, and <code>vcomp</code> are
generated to indicate the required input order.</p></li>
<li><p><strong><code>REML</code>:</strong> (logical) Whether to use the
REML or ML information matrix. The default is <code>TRUE</code>
(REML).</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="standard_design">Specific design functions<a class="anchor" aria-label="anchor" href="#standard_design"></a>
</h3>
<p>While <code>mkdesign</code> provides full flexibility,
<strong>pwr4exp</strong> also offers specific functions for common
experimental designs. These functions allow users to define a design
based on treatment structure and replications without manually creating
a data frame.</p>
<blockquote>
<p><strong>Completely randomized design (CRD)</strong></p>
</blockquote>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_designs.html">designCRD</a></span><span class="op">(</span><span class="va">treatments</span>, <span class="va">label</span>, <span class="va">replicates</span>, <span class="va">formula</span>, <span class="va">beta</span>, <span class="va">means</span>, <span class="va">sigma2</span>, template <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><strong>Randomized complete block design (RCBD)</strong></p>
</blockquote>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_designs.html">designRCBD</a></span><span class="op">(</span><span class="va">treatments</span>, <span class="va">label</span>, <span class="va">blocks</span>, <span class="va">formula</span>, <span class="va">beta</span>, <span class="va">means</span>, <span class="va">vcomp</span>, <span class="va">sigma2</span>, template <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><strong>Latin square design (LSD)</strong></p>
</blockquote>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_designs.html">designLSD</a></span><span class="op">(</span><span class="va">treatments</span>, <span class="va">label</span>, <span class="va">squares</span>, <span class="va">reuse</span>, <span class="va">formula</span>, <span class="va">beta</span>, <span class="va">means</span>, <span class="va">vcomp</span>, <span class="va">sigma2</span>, template <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><strong>Crossover design</strong></p>
</blockquote>
<p>This is a special case of LSD where time periods and individuals act
as blocks. Period blocks are reused when replicating squares.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_designs.html">designCOD</a></span><span class="op">(</span><span class="va">treatments</span>, <span class="va">label</span>, <span class="va">squares</span>, <span class="va">formula</span>, <span class="va">beta</span>, <span class="va">means</span>, <span class="va">vcomp</span>, <span class="va">sigma2</span>, template <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><strong>Split-plot design (SPD)</strong></p>
</blockquote>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_designs.html">designSPD</a></span><span class="op">(</span><span class="va">trt.main</span>, <span class="va">trt.sub</span>, <span class="va">label</span>, <span class="va">replicates</span>, <span class="va">formula</span>, <span class="va">beta</span>, <span class="va">means</span>, <span class="va">vcomp</span>, <span class="va">sigma2</span>, template <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The inputs for these functions are similar to <code>mkdesign</code>,
except that <code>data</code> is replaced by predefined design
characteristics such as treatment levels and replications.</p>
<p><strong>Key inputs</strong></p>
<blockquote>
<ul>
<li><p><strong><code>treatments</code></strong>: A numeric vector
specifying the number of levels for treatment factors. Multiple factors
are arranged factorially. For example, <code>treatments = c(3, 2)</code>
specifies two treatment factors one with 3 levels and another with 2
levels, forming a factorial treatment design.</p></li>
<li><p><strong><code>trt.main</code></strong> and
<strong><code>trt.sub</code></strong>: Define main-plot and subplot
treatments for SPD, following the same rule for
<code>treatment</code>.</p></li>
<li><p><strong><code>label</code></strong>: (optional) A list assigning
labels to factor levels. If not specified, default names are assigned.
For one treatment factor, the default is
<code>list(trt = c("1", "2", ...))</code>. For two factors, the default
is <code>list(facA = c("1", "2", ...), facB = c("1", "2", ...))</code>,
where “facA” and “facB” represent the two factors, and “1”, “2”, etc.,
represent the levels of each factor.</p></li>
<li><p><strong><code>replicates</code></strong>: Number of experimental
units per treatment in CRD or number of main plots (i.e., the number of
experimental units per main-plot treatment) in SPD.</p></li>
<li><p><strong><code>blocks</code></strong>: Number of blocks in
RCBD.</p></li>
<li><p><strong><code>squares</code></strong>: Number of squares in LSD
or COD.</p></li>
<li><p><strong><code>reuse</code></strong>: Specifies how squares are
replicated in LSD. One of:</p></li>
</ul>
<blockquote>
<ul>
<li>
<code>"row"</code>: reuse row blocks</li>
<li>
<code>"col"</code>: reuse column blocks</li>
<li>
<code>"both"</code>: reuse both row and column blocks</li>
</ul>
</blockquote>
<ul>
<li>
<a href="#template"><strong><code>template</code></strong></a>: When
set to <code>TRUE</code>, templates for <code>beta</code>,
<code>means</code>, and <code>vcomp</code> are generated to indicate the
required input order.</li>
</ul>
</blockquote>
<p>Each of these design-generating functions has a default
<code>formula</code> based on the treatment structure (e.g., one factor
or factorial factors). If <code>formula</code> is not specified, a
default formula with main effects and all interactions (if applicable)
is used internally. In RCBD, LSD, COD, and SPD designs, all block
factors are fitted as random effects. The <code>formula</code> component
in the output design object (a <code>list</code>) can be inspected.</p>
</div>
<div class="section level3">
<h3 id="template">Parameter templates<a class="anchor" aria-label="anchor" href="#template"></a>
</h3>
<p>Templates help ensure the correct ordering of fixed effects
(<code>beta</code> or <code>means</code>) and random effects
(<code>vcomp</code>).</p>
<p>Below, an exemplary data frame is created to illustrate these
templates. Note that this example <strong>does NOT</strong> represent a
realistic design. The data frame includes:</p>
<blockquote>
<ul>
<li>Four categorical variables (<code>fA</code>, <code>fB</code>,
<code>fC</code>, <code>fD</code>),</li>
<li>Two numerical variables (<code>x</code>, <code>z</code>).</li>
</ul>
</blockquote>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>   fA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="co"># factor A with 2 levels</span></span>
<span>   fB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="co"># factor B with 2 levels</span></span>
<span>   fC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="co"># factor C with 3 levels</span></span>
<span>   fD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="co"># factor D with 3 levels</span></span>
<span>   subject <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>  <span class="co"># 10 subjects</span></span>
<span> <span class="op">)</span></span>
<span> <span class="va">df1</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Numerical variable x</span></span>
<span> <span class="va">df1</span><span class="op">$</span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Numerical variable z</span></span></code></pre></div>
<div class="section level4">
<h4 id="fixeff_template">
<code>beta</code> Template<a class="anchor" aria-label="anchor" href="#fixeff_template"></a>
</h4>
<blockquote>
<p>The <code>beta</code> template displays the order of model
coefficients in the fitted model.</p>
</blockquote>
<p>This is particularly useful when specifying expected model
coefficients directly as effect size measures and when the model
includes complex interactions. For example, the expected values of the
model coefficients for <code>~ fA*fB + x</code> should be provided in
the following sequence:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mkdesign.html">mkdesign</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">fA</span> <span class="op">*</span> <span class="va">fB</span> <span class="op">+</span> <span class="va">x</span>, <span class="va">df1</span><span class="op">)</span><span class="op">$</span><span class="va">fixeff</span><span class="op">$</span><span class="va">beta</span></span>
<span><span class="co">#&gt; (Intercept)         fA2         fB2           x     fA2:fB2 </span></span>
<span><span class="co">#&gt;           1           2           3           4           5</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="means-template">
<code>means</code> Template<a class="anchor" aria-label="anchor" href="#means-template"></a>
</h4>
<p>For treatment factors, it may be more more convenient to provide
<code>means</code> instead of <code>beta</code>. The <code>means</code>
template represents either marginal or cell means for factors, depending
on the presence of interactions. For numerical variables included in the
model, regression coefficients remain necessary alongside alongside the
means for factors.</p>
<p><strong>Factors without interactions</strong></p>
<blockquote>
<p>If no interactions are present, <strong>marginal means</strong> for
each factor level are required.</p>
</blockquote>
<p>For example, for the model <code>~ fA + fB</code>, means should be
reported in the order specified by the template:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mkdesign.html">mkdesign</a></span><span class="op">(</span><span class="op">~</span> <span class="va">fA</span> <span class="op">+</span> <span class="va">fB</span>, <span class="va">df1</span>, template <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">fixeff</span><span class="op">$</span><span class="va">means</span></span>
<span><span class="co">#&gt; fA1 fA2 fB1 fB2 </span></span>
<span><span class="co">#&gt;   1   2   3   4</span></span></code></pre></div>
<p><strong>Interactions among factors</strong></p>
<blockquote>
<p>When factors interact, <strong>conditional (cell) means</strong> must
be provided for all possible combinations of their levels.</p>
</blockquote>
<p>For example, for a model with three interacting factors
(<code>fA</code>, <code>fB</code>, <code>fC</code>), cell means are
required for all 12 level combinations in the following order:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mkdesign.html">mkdesign</a></span><span class="op">(</span><span class="op">~</span> <span class="va">fA</span> <span class="op">*</span> <span class="va">fB</span> <span class="op">*</span> <span class="va">fC</span>, <span class="va">df1</span><span class="op">)</span><span class="op">$</span><span class="va">fixeff</span><span class="op">$</span><span class="va">means</span></span>
<span><span class="co">#&gt; fA1:fB1:fC1 fA2:fB1:fC1 fA1:fB2:fC1 fA2:fB2:fC1 fA1:fB1:fC2 fA2:fB1:fC2 </span></span>
<span><span class="co">#&gt;           1           2           3           4           5           6 </span></span>
<span><span class="co">#&gt; fA1:fB2:fC2 fA2:fB2:fC2 fA1:fB1:fC3 fA2:fB1:fC3 fA1:fB2:fC3 fA2:fB2:fC3 </span></span>
<span><span class="co">#&gt;           7           8           9          10          11          12</span></span></code></pre></div>
<p><strong>Numerical variables</strong></p>
<blockquote>
<p>For numerical variables, regression coefficients are required. If the
model only includes numerical variables, the intercept must also be
included. In this case, the values in means are identical to beta:</p>
</blockquote>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mkdesign.html">mkdesign</a></span><span class="op">(</span><span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="va">z</span>, <span class="va">df1</span><span class="op">)</span><span class="op">$</span><span class="va">fixeff</span><span class="op">$</span><span class="va">means</span></span>
<span><span class="co">#&gt; (Intercept)           x           z </span></span>
<span><span class="co">#&gt;           1           2           3</span></span></code></pre></div>
<blockquote>
<p>When numerical variables interact, regression coefficients for both
main effects and interaction terms must be included.</p>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mkdesign.html">mkdesign</a></span><span class="op">(</span><span class="op">~</span> <span class="va">x</span> <span class="op">*</span> <span class="va">z</span>, <span class="va">df1</span><span class="op">)</span><span class="op">$</span><span class="va">fixeff</span><span class="op">$</span><span class="va">means</span></span>
<span><span class="co">#&gt; (Intercept)           x           z         x:z </span></span>
<span><span class="co">#&gt;           1           2           3           4</span></span></code></pre></div>
<p><strong>Factor-by-numerical interactions</strong></p>
<blockquote>
<p>For interactions between factor and numerical variables, both
<strong>Marginal means</strong> for the factor, and <strong>Regression
coefficients</strong> for the numerical variable at each level of the
factor must be provided.</p>
</blockquote>
<p>For instance, in the model <code>~ fA * x</code>, the means for
levels of <code>fA</code> and the regression coefficients for
<code>x</code> at each level of <code>fA</code> must be provided:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mkdesign.html">mkdesign</a></span><span class="op">(</span><span class="op">~</span> <span class="va">fA</span> <span class="op">*</span> <span class="va">x</span>, <span class="va">df1</span><span class="op">)</span><span class="op">$</span><span class="va">fixeff</span><span class="op">$</span><span class="va">means</span></span>
<span><span class="co">#&gt;   fA1   fA2 fA1:x fA2:x </span></span>
<span><span class="co">#&gt;     1     2     3     4</span></span></code></pre></div>
<p><strong>Combining Multiple Situations</strong></p>
<blockquote>
<p>The rules outlined for factor and numerical variables apply when
multiple types of variables and interactions appear in the same
model.</p>
</blockquote>
<p>For example, consider a model including interactions among three
factors (<code>fA</code>, <code>fB</code>, <code>fC</code>),
factor-by-numerical interaction (<code>fD * x</code>), and main effects
for another numerical variable (<code>z</code>).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mkdesign.html">mkdesign</a></span><span class="op">(</span><span class="op">~</span> <span class="va">fA</span> <span class="op">*</span> <span class="va">fB</span> <span class="op">*</span> <span class="va">fC</span> <span class="op">+</span> <span class="va">fD</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="va">z</span>, <span class="va">df1</span><span class="op">)</span><span class="op">$</span><span class="va">fixeff</span><span class="op">$</span><span class="va">means</span></span>
<span><span class="co">#&gt;         fD1         fD2         fD3           z       fD1:x       fD2:x </span></span>
<span><span class="co">#&gt;           1           2           3           4           5           6 </span></span>
<span><span class="co">#&gt;       fD3:x fA1:fB1:fC1 fA2:fB1:fC1 fA1:fB2:fC1 fA2:fB2:fC1 fA1:fB1:fC2 </span></span>
<span><span class="co">#&gt;           7           8           9          10          11          12 </span></span>
<span><span class="co">#&gt; fA2:fB1:fC2 fA1:fB2:fC2 fA2:fB2:fC2 fA1:fB1:fC3 fA2:fB1:fC3 fA1:fB2:fC3 </span></span>
<span><span class="co">#&gt;          13          14          15          16          17          18 </span></span>
<span><span class="co">#&gt; fA2:fB2:fC3 </span></span>
<span><span class="co">#&gt;          19</span></span></code></pre></div>
<p>The required elements and their order in means are:</p>
<p>1. Means for each level of <code>fD</code> (positions 1–3)</p>
<p>2. Regression coefficient for <code>z</code> (position 4)</p>
<p>3. Regression coefficients for <code>x</code> at each level of
<code>fD</code> (positions 5–7)</p>
<p>4. Cell means for all combinations of levels of <code>fA</code>,
<code>fB</code>, and <code>fC</code> (positions 8–19)</p>
</div>
<div class="section level4">
<h4 id="vcomp_template">
<code>vcomp</code> Template<a class="anchor" aria-label="anchor" href="#vcomp_template"></a>
</h4>
<blockquote>
<p>The <code>vcomp</code> template represents variance-covariance
matrices, where integer values indicate the order of variance components
in the input vector.</p>
</blockquote>
<p>For a single random effect, a template is unnecessary since it
corresponds to a single variance value. For multiple random effects, the
template specifies the sequence of variance and covariance components,
ensuring proper alignment when specifying variance components in the
model.</p>
<p>For example, consider a model that includes both a random intercept
and a random slope for <code>fA</code> by <code>subject</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mkdesign.html">mkdesign</a></span><span class="op">(</span><span class="op">~</span> <span class="va">fA</span> <span class="op">*</span> <span class="va">fB</span> <span class="op">*</span> <span class="va">fC</span> <span class="op">*</span> <span class="va">fD</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">fA</span> <span class="op">|</span> <span class="va">subject</span><span class="op">)</span>, <span class="va">df1</span><span class="op">)</span><span class="op">$</span><span class="va">varcov</span></span>
<span><span class="co">#&gt; $subject</span></span>
<span><span class="co">#&gt;             (Intercept) fA2</span></span>
<span><span class="co">#&gt; (Intercept)           1   2</span></span>
<span><span class="co">#&gt; fA2                   2   3</span></span></code></pre></div>
<p>The template specifies the following required inputs:</p>
<ol style="list-style-type: decimal">
<li><p>Variance of the random intercept</p></li>
<li><p>Covariance between the random intercept and slop</p></li>
<li><p>Variance of the random slop (<code>fA2</code>)</p></li>
</ol>
</div>
</div>
<div class="section level3">
<h3 id="correlation-structures">Correlation structures<a class="anchor" aria-label="anchor" href="#correlation-structures"></a>
</h3>
<p>Although specifying complex variance-covariance structures, such as
unstructured <code><a href="https://rdrr.io/pkg/nlme/man/corSymm.html" class="external-link">nlme::corSymm</a></code>, may seem impractical for power
analysis, various correlation structures from the <strong>nlme</strong>
package can be applies.</p>
<p>The available correlation structures, as outlined in <a href="https://www.rdocumentation.org/packages/nlme/versions/3.1-167/topics/corClasses" class="external-link"><code>nlme::corClasses</code></a>,
including</p>
<ul>
<li><p><a href="https://www.rdocumentation.org/packages/nlme/versions/3.1-163/topics/corAR1" class="external-link"><code>corAR1</code></a>
– First-order autoregressive</p></li>
<li><p><a href="https://www.rdocumentation.org/packages/nlme/versions/3.1-163/topics/corARMA" class="external-link"><code>corARMA</code></a>
– Autoregressive moving average</p></li>
<li><p><a href="https://www.rdocumentation.org/packages/nlme/versions/3.1-163/topics/corCAR1" class="external-link"><code>corCAR1</code></a>
– Continuous-time autoregressive</p></li>
<li><p><a href="https://www.rdocumentation.org/packages/nlme/versions/3.1-163/topics/corCompSymm" class="external-link"><code>corCompSymm</code></a>
– Compound symmetry</p></li>
<li><p><a href="https://www.rdocumentation.org/packages/nlme/versions/3.1-163/topics/corExp" class="external-link"><code>corExp</code></a>
– Exponential spatial correlation</p></li>
<li><p><a href="https://www.rdocumentation.org/packages/nlme/versions/3.1-163/topics/corGaus" class="external-link"><code>corGaus</code></a>
– Gaussian spatial correlation</p></li>
<li><p><a href="https://www.rdocumentation.org/packages/nlme/versions/3.1-163/topics/corLin" class="external-link"><code>corLin</code></a>
– Linear spatial correlation</p></li>
<li><p><a href="https://www.rdocumentation.org/packages/nlme/versions/3.1-163/topics/corSymm" class="external-link"><code>corSymm</code></a>
– Unstructured correlation</p></li>
<li><p><a href="https://www.rdocumentation.org/packages/nlme/versions/3.1-163/topics/corRatio" class="external-link"><code>corRatio</code></a>
– Ratio-based spatial correlation</p></li>
<li><p><a href="https://www.rdocumentation.org/packages/nlme/versions/3.1-163/topics/corSpher" class="external-link"><code>corSpher</code></a>
– Spherical spatial correlation</p></li>
</ul>
<p>Note: In <code><a href="https://rdrr.io/pkg/nlme/man/corAR1.html" class="external-link">nlme::corAR1()</a></code> and <code><a href="https://rdrr.io/pkg/nlme/man/corARMA.html" class="external-link">nlme::corARMA()</a></code>
when <code>p=1</code> and <code>q=0</code>, the time variable must be an
integer. However, in <code>pwr4exp</code>, this restriction has been
released, factors are also supported.</p>
</div>
</div>
<div class="section level2">
<h2 id="power">Power calculation<a class="anchor" aria-label="anchor" href="#power"></a>
</h2>
<p>Once a design object has been created, calculating statistical power
is straightforward.</p>
<div class="section level3">
<h3 id="power-calculation-for-omnibus-f-tests">Power Calculation for Omnibus F-Tests<a class="anchor" aria-label="anchor" href="#power-calculation-for-omnibus-f-tests"></a>
</h3>
<p>The statistical power for <strong>F-tests</strong> (ANOVA-like tests)
can be computed using the <code>pwr.anova</code> function.</p>
<p><strong>Usage</strong></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.anova.html">pwr.anova</a></span><span class="op">(</span><span class="va">object</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong></p>
<ul>
<li><p><strong><code>object</code></strong>: the design object created
in the previous step.</p></li>
<li><p><strong><code>sig.level</code></strong>: significance level,
default <code>0.05</code>.</p></li>
<li><p><strong><code>type</code></strong>: the type of ANOVA table
(default: <code>3</code>).</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="power-calculation-for-specific-contrasts">Power Calculation for Specific Contrasts<a class="anchor" aria-label="anchor" href="#power-calculation-for-specific-contrasts"></a>
</h3>
<p>To evaluate statistical power for <strong>t-tests</strong> on
specific contrasts, use the <code>pwr.contrast</code> function.</p>
<p><strong>Usage</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">which</span>, by <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pairwise"</span>, <span class="st">"poly"</span>, <span class="st">"trt.vs.ctrl"</span><span class="op">)</span>,</span>
<span>  sig.level <span class="op">=</span> <span class="fl">0.05</span>, p.adj <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"two.sided"</span>, <span class="st">"one.sided"</span><span class="op">)</span>, strict <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong></p>
<ul>
<li><p><strong><code>object</code></strong>: The design object.</p></li>
<li><p><strong><code>which</code></strong>: The factor of interest.
Multiple factors can be combined using <code>:</code> or <code>*</code>
(e.g., <code>"facA*facB"</code> treats combined factor levels as a
single factor).</p></li>
<li><p><strong><code>by</code></strong>: The variable to condition
on.</p></li>
<li>
<p><strong><code>contrast</code></strong>: Contrast method, on
of</p>
<ul>
<li><p><code>"pairwise"</code> - pairwise comparisons</p></li>
<li><p><code>"poly"</code> - polynomial contrasts</p></li>
<li><p><code>"trt.vs.ctrl"</code> - treatment vs. control
comparison</p></li>
<li><p>Alternatively, a <strong>numeric vector</strong> for a single
custom contrast, or a <strong>named list</strong> of contrast vectors.
If a list is provided, each vector must match the number of factor
levels in each <code>by</code> group. In multi-factor scenarios, factor
levels are combined and treated as a single factor.</p></li>
</ul>
</li>
<li><p><strong><code>sig.level</code></strong>: significance level
(default: <code>0.05</code>).</p></li>
<li><p><strong><code>p.adj</code></strong>: whether the
<code>sig.level</code> should be adjusted using the Bonferroni method
(default: FALSE).</p></li>
<li><p><strong><code>alternative</code></strong>:
<code>"two.sided"</code> (default) or <code>"one.sided"</code>.</p></li>
<li><p><strong><code>strict</code></strong>: Controls how power is
calculated in two-sided tests (default: <code>TRUE</code>). If
<code>TRUE</code>, includes the probability of rejection in the opposite
direction of the true effect. If <code>FALSE</code>, power equals half
the significance level when the true difference is zero.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="power-calculation-for-model-coefficients">Power Calculation for Model Coefficients<a class="anchor" aria-label="anchor" href="#power-calculation-for-model-coefficients"></a>
</h3>
<p>The <code>pwr.summary</code> function computes the statistical power
for testing model coefficients (t-tests).</p>
<p><strong>Usage</strong></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.summary.html">pwr.summary</a></span><span class="op">(</span><span class="va">object</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong></p>
<ul>
<li>
<strong><code>object</code></strong>: A design object</li>
<li>
<strong><code>sig.level</code></strong>: The significance level
(default: 0.05)</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="practical-examples">Practical Examples<a class="anchor" aria-label="anchor" href="#practical-examples"></a>
</h2>
<div class="section level3">
<h3 id="example-1--completely-randomized-design">Example 1. Completely Randomized Design<a class="anchor" aria-label="anchor" href="#example-1--completely-randomized-design"></a>
</h3>
<p>In this example, we create a CRD with one treatment factor.</p>
<p><strong>Design parameters</strong></p>
<ol style="list-style-type: decimal">
<li>
<strong>Treatments</strong>: 1 treatment factor with 4 levels.</li>
<li>
<strong>Replicates</strong>: 8 experimental units per
treatment.</li>
<li>
<strong>Mean and effect size</strong>: Expected means for four
levels: 35, 30, 37, 38</li>
<li>
<strong>Error variance</strong>: 15</li>
</ol>
<p><strong>Step 1: Creating the CRD</strong></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_designs.html">designCRD</a></span><span class="op">(</span></span>
<span>  treatments <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  replicates <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35</span>, <span class="fl">30</span>, <span class="fl">37</span>, <span class="fl">38</span><span class="op">)</span>,</span>
<span>  sigma2 <span class="op">=</span> <span class="fl">15</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Step 2: Power for omnibus test</strong></p>
<p>To compute the power for the <strong>overall F-test
(ANOVA)</strong>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.anova.html">pwr.anova</a></span><span class="op">(</span><span class="va">crd</span><span class="op">)</span></span>
<span><span class="co">#&gt; Power of type III F-test</span></span>
<span><span class="co">#&gt;     NumDF DenDF sig.level   power</span></span>
<span><span class="co">#&gt; trt     3    28      0.05 0.95467</span></span></code></pre></div>
<p><strong>Step 3: Power for specific contrasts</strong></p>
<blockquote>
<p><strong>a) Pairwise Comparisons</strong></p>
</blockquote>
<p>To compute power for pairwise differences:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span><span class="va">crd</span>, which <span class="op">=</span>  <span class="st">"trt"</span>, contrast <span class="op">=</span> <span class="st">"pairwise"</span><span class="op">)</span></span>
<span><span class="co">#&gt;             effect df sig.level      power alternative</span></span>
<span><span class="co">#&gt; trt1 - trt2      5 28      0.05 0.70287390   two.sided</span></span>
<span><span class="co">#&gt; trt1 - trt3     -2 28      0.05 0.16949749   two.sided</span></span>
<span><span class="co">#&gt; trt1 - trt4     -3 28      0.05 0.32168033   two.sided</span></span>
<span><span class="co">#&gt; trt2 - trt3     -7 28      0.05 0.93677955   two.sided</span></span>
<span><span class="co">#&gt; trt2 - trt4     -8 28      0.05 0.97860686   two.sided</span></span>
<span><span class="co">#&gt; trt3 - trt4     -1 28      0.05 0.07896844   two.sided</span></span></code></pre></div>
<blockquote>
<p><strong>b) Polynomial Contrasts</strong></p>
</blockquote>
<p>To test for trends across treatment levels:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span><span class="va">crd</span>, which <span class="op">=</span>  <span class="st">"trt"</span>, contrast <span class="op">=</span> <span class="st">"poly"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           effect df sig.level     power alternative</span></span>
<span><span class="co">#&gt; linear        16 28      0.05 0.7130735   two.sided</span></span>
<span><span class="co">#&gt; quadratic      6 28      0.05 0.5617849   two.sided</span></span>
<span><span class="co">#&gt; cubic        -18 28      0.05 0.8098383   two.sided</span></span></code></pre></div>
<blockquote>
<p><strong>c) Treatment vs. Control Comparison</strong></p>
</blockquote>
<p>The power for detecting differences between treatments and the
control:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span><span class="va">crd</span>, which <span class="op">=</span>  <span class="st">"trt"</span>, contrast <span class="op">=</span> <span class="st">"trt.vs.ctrl"</span><span class="op">)</span></span>
<span><span class="co">#&gt;             effect df sig.level     power alternative</span></span>
<span><span class="co">#&gt; trt2 - trt1     -5 28      0.05 0.7028739   two.sided</span></span>
<span><span class="co">#&gt; trt3 - trt1      2 28      0.05 0.1694975   two.sided</span></span>
<span><span class="co">#&gt; trt4 - trt1      3 28      0.05 0.3216803   two.sided</span></span></code></pre></div>
<blockquote>
<p><strong>d) Custom Contrast: All Treatments vs. Control</strong></p>
</blockquote>
<p>In addition to pre-defined contrast method, custom contrast vectors
can be specified. For example, to compare the average of all treatments
against the control, use the contrast vector
<code>c(-1, 1/3, 1/3, 1/3)</code>. The power for this test can be
computed as:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span><span class="va">crd</span>, which <span class="op">=</span>  <span class="st">"trt"</span>, contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trts.vs.ctrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    effect df sig.level power alternative</span></span>
<span><span class="co">#&gt; trts.vs.ctrl 2.442491e-15 28      0.05  0.05   two.sided</span></span></code></pre></div>
<p><strong>Adjusting for Multiple Comparisons</strong></p>
<p>In real-world analysis, <strong>P-values</strong> often need
<strong>adjustment for multiple comparisons (MCP)</strong>. While most
<strong>post-hoc</strong> methods cannot be applied <strong>directly in
power analysis</strong>, we can <strong>lower the significance
level</strong> to approximate MCP adjustments.</p>
<blockquote>
<p><strong>Using a More Conservative Significance Level</strong></p>
</blockquote>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span><span class="va">crd</span>, which <span class="op">=</span>  <span class="st">"trt"</span>, contrast <span class="op">=</span> <span class="st">"pairwise"</span>, sig.level <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="co">#&gt;             effect df sig.level     power alternative</span></span>
<span><span class="co">#&gt; trt1 - trt2      5 28      0.01 0.4418907   two.sided</span></span>
<span><span class="co">#&gt; trt1 - trt3     -2 28      0.01 0.0546995   two.sided</span></span>
<span><span class="co">#&gt; trt1 - trt4     -3 28      0.01 0.1320866   two.sided</span></span>
<span><span class="co">#&gt; trt2 - trt3     -7 28      0.01 0.7946290   two.sided</span></span>
<span><span class="co">#&gt; trt2 - trt4     -8 28      0.01 0.9042775   two.sided</span></span>
<span><span class="co">#&gt; trt3 - trt4     -1 28      0.01 0.0194487   two.sided</span></span></code></pre></div>
<blockquote>
<p><strong>Using the Bonferroni Correction</strong></p>
<p>The <code>pwr.contrast</code> function includes an option for
<strong>Bonferroni correction</strong>, though it may be overly
conservative:</p>
</blockquote>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span><span class="va">crd</span>, which <span class="op">=</span>  <span class="st">"trt"</span>, contrast <span class="op">=</span> <span class="st">"pairwise"</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span>, p.adj <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;             effect df   sig.level      power alternative</span></span>
<span><span class="co">#&gt; trt1 - trt2      5 28 0.008333333 0.41456682   two.sided</span></span>
<span><span class="co">#&gt; trt1 - trt3     -2 28 0.008333333 0.04782486   two.sided</span></span>
<span><span class="co">#&gt; trt1 - trt4     -3 28 0.008333333 0.11835238   two.sided</span></span>
<span><span class="co">#&gt; trt2 - trt3     -7 28 0.008333333 0.77333066   two.sided</span></span>
<span><span class="co">#&gt; trt2 - trt4     -8 28 0.008333333 0.89102508   two.sided</span></span>
<span><span class="co">#&gt; trt3 - trt4     -1 28 0.008333333 0.01655798   two.sided</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-2--randomized-complete-block-design">Example 2. Randomized complete block design<a class="anchor" aria-label="anchor" href="#example-2--randomized-complete-block-design"></a>
</h3>
<p>In this example, we create a <strong>Randomized Complete Block Design
(RCBD)</strong> with <strong>two treatment factors</strong> in a
<strong>2×2 factorial design</strong>.</p>
<p><strong>Design Parameters</strong></p>
<ol style="list-style-type: decimal">
<li>
<strong>Treatments</strong>: A 2x2 factorial design (factors:
<code>A</code> and <code>B</code>).</li>
<li>
<strong>Replicates</strong>: 8 blocks.</li>
<li>
<strong>Expected Means</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>B</mi><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>B</mi><mn>2</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>A</mi><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>35</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>38</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>A</mi><mn>2</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>40</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>41</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">
    \begin{array}{c|c|c}
 &amp; B1 &amp; B2 \\
    \hline
    A1 &amp; 35 &amp; 38 \\
    A2 &amp; 40  &amp; 41 \\
    \end{array}
    </annotation></semantics></math> Corresponding <code>beta</code>
values are as follows (Optional):</li>
</ol>
<ul>
<li><em>Intercept (<code>A1B1</code>): 35</em></li>
<li><em>Effect of <code>A2</code> alone: 5 units</em></li>
<li><em>Effect of <code>B2</code> alone: 3 units</em></li>
<li><em>Interaction (<code>A2:B2</code>): -2 units (i.e., the combined
effect of <code>A2</code> and <code>B2</code> is 2 units below the
additive effects).</em></li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>Variance among blocks</strong>: 11.</li>
<li>
<strong>Error variance</strong>: 4.</li>
<li>The total variance of the response variable (15) is decomposed into
variance between blocks (11) and variance within blocks (4).</li>
</ol>
<p><strong>Step 1: Creating the RCBD</strong></p>
<ul>
<li>
<strong>Generate the templates</strong> to determine the correct
parameter order. Provide <code>beta</code> or <code>means</code>, and
<code>vcomp</code> according to the order below.</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_designs.html">designRCBD</a></span><span class="op">(</span>treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, blocks <span class="op">=</span> <span class="fl">8</span>, template <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; $fixeff</span></span>
<span><span class="co">#&gt; $fixeff$beta</span></span>
<span><span class="co">#&gt; (Intercept)       facA2       facB2 facA2:facB2 </span></span>
<span><span class="co">#&gt;           1           2           3           4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fixeff$means</span></span>
<span><span class="co">#&gt; facA1:facB1 facA2:facB1 facA1:facB2 facA2:facB2 </span></span>
<span><span class="co">#&gt;           1           2           3           4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $varcov</span></span>
<span><span class="co">#&gt; $varcov$block</span></span>
<span><span class="co">#&gt;             (Intercept)</span></span>
<span><span class="co">#&gt; (Intercept)           1</span></span></code></pre></div>
<ul>
<li><strong>Create the design object</strong></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rcbd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_designs.html">designRCBD</a></span><span class="op">(</span></span>
<span>  treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  blocks <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  <span class="co"># beta = c(35, 5, 3, -2), # identical to means</span></span>
<span>  means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35</span>, <span class="fl">40</span>, <span class="fl">38</span>, <span class="fl">41</span><span class="op">)</span>,</span>
<span>  vcomp <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  sigma2 <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The default factor names and formula can be inspected in the design
object:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">rcbd</span><span class="op">$</span><span class="va">deStruct</span><span class="op">$</span><span class="va">fxTrms</span><span class="op">$</span><span class="va">fixedfr</span><span class="op">)</span></span>
<span><span class="co">#&gt;   facA facB</span></span>
<span><span class="co">#&gt; 1    1    1</span></span>
<span><span class="co">#&gt; 2    2    1</span></span>
<span><span class="co">#&gt; 3    1    2</span></span>
<span><span class="co">#&gt; 4    2    2</span></span>
<span><span class="va">rcbd</span><span class="op">$</span><span class="va">deStruct</span><span class="op">$</span><span class="va">formula</span></span>
<span><span class="co">#&gt; ~facA * facB + (1 | block)</span></span>
<span><span class="co">#&gt; &lt;environment: 0x561e763d6cc8&gt;</span></span></code></pre></div>
<p>Treatment factors and factor levels can be renamed and relabeled, and
the model formula can be changed. For example, if interactions are
removed, marginal means for both factors must be provided instead of
cell means.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_designs.html">designRCBD</a></span><span class="op">(</span>treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>factorA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A2"</span><span class="op">)</span>, factorB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B1"</span>, <span class="st">"B2"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>           blocks <span class="op">=</span> <span class="fl">8</span>, </span>
<span>           formula <span class="op">=</span> <span class="op">~</span> <span class="va">factorA</span> <span class="op">+</span> <span class="va">factorB</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">block</span><span class="op">)</span>, </span>
<span>           template <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; $fixeff</span></span>
<span><span class="co">#&gt; $fixeff$beta</span></span>
<span><span class="co">#&gt; (Intercept)   factorAA2   factorBB2 </span></span>
<span><span class="co">#&gt;           1           2           3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fixeff$means</span></span>
<span><span class="co">#&gt; factorAA1 factorAA2 factorBB1 factorBB2 </span></span>
<span><span class="co">#&gt;         1         2         3         4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $varcov</span></span>
<span><span class="co">#&gt; $varcov$block</span></span>
<span><span class="co">#&gt;             (Intercept)</span></span>
<span><span class="co">#&gt; (Intercept)           1</span></span></code></pre></div>
<p><strong>Step 2: Evaluate statistical power</strong></p>
<p>To test overall effects of <code>facA</code> and
<code>facB</code></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.anova.html">pwr.anova</a></span><span class="op">(</span><span class="va">rcbd</span><span class="op">)</span></span>
<span><span class="co">#&gt; Power of type III F-test</span></span>
<span><span class="co">#&gt;           NumDF DenDF sig.level   power</span></span>
<span><span class="co">#&gt; facA          1    21      0.05 0.99969</span></span>
<span><span class="co">#&gt; facB          1    21      0.05 0.76950</span></span>
<span><span class="co">#&gt; facA:facB     1    21      0.05 0.27138</span></span></code></pre></div>
<p>To test differences between levels of <code>facA</code>, conditioned
on <code>facB</code>:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span><span class="va">rcbd</span>, which <span class="op">=</span> <span class="st">"facA"</span>, by <span class="op">=</span> <span class="st">"facB"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`facB = 1`</span></span>
<span><span class="co">#&gt;               effect df sig.level     power alternative</span></span>
<span><span class="co">#&gt; facA1 - facA2     -5 21      0.05 0.9974502   two.sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`facB = 2`</span></span>
<span><span class="co">#&gt;               effect df sig.level     power alternative</span></span>
<span><span class="co">#&gt; facA1 - facA2     -3 21      0.05 0.8160596   two.sided</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-3--latin-square-design">Example 3. Latin square design<a class="anchor" aria-label="anchor" href="#example-3--latin-square-design"></a>
</h3>
<p>In this example, we extend <em>Example 2</em> by introducing
<strong>another blocking factor</strong>, transforming the design into
an LSD.</p>
<ul>
<li><p>The <strong>treatment structure and effect sizes remain the
same</strong> as in <em>Example 2</em>.</p></li>
<li><p>The LSD controls for <strong>two sources of variability</strong>
(row and column blocks) while evaluating treatment effects.</p></li>
<li>
<p>The <strong>total variance (15)</strong> is further decomposed
into:</p>
<ul>
<li><p><strong>Variance between row blocks</strong>:
<code>11</code></p></li>
<li><p><strong>Variance between column blocks</strong>:
<code>2</code></p></li>
<li><p><strong>Residual error variance</strong>: <code>2</code></p></li>
</ul>
</li>
</ul>
<p><strong>Step 1: Creating the LSD</strong></p>
<p>Generate the templates to determine the correct order of inputs.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_designs.html">designLSD</a></span><span class="op">(</span></span>
<span>  treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  squares <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  reuse <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  template <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $fixeff</span></span>
<span><span class="co">#&gt; $fixeff$beta</span></span>
<span><span class="co">#&gt; (Intercept)       facA2       facB2 facA2:facB2 </span></span>
<span><span class="co">#&gt;           1           2           3           4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fixeff$means</span></span>
<span><span class="co">#&gt; facA1:facB1 facA2:facB1 facA1:facB2 facA2:facB2 </span></span>
<span><span class="co">#&gt;           1           2           3           4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $varcov</span></span>
<span><span class="co">#&gt; $varcov$row</span></span>
<span><span class="co">#&gt;             (Intercept)</span></span>
<span><span class="co">#&gt; (Intercept)           1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $varcov$col</span></span>
<span><span class="co">#&gt;             (Intercept)</span></span>
<span><span class="co">#&gt; (Intercept)           2</span></span></code></pre></div>
<p>Either <code>beta</code> or <code>means</code> can be provided, as in
<em>Example 2</em>. Note that although the variance component template
sets the order for <code>row</code> and <code>col</code> variances in
<code>vcomp</code>, these values don’t impact power as long as
<code>sigma2</code> is fixed because treatment effects are tested
against residual error. However, in designs where the error terms for
treatment factors include variance components beyond residual error
(like the next example), variance components can affect power for main
plot factors. It’s also recommended to use variance components as a
guide to make an informed estimate of <code>sigma2</code>.</p>
<p><strong>Create the LSD</strong></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lsd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_designs.html">designLSD</a></span><span class="op">(</span></span>
<span>  treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T1"</span>, <span class="st">"T2"</span><span class="op">)</span>, dosage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D1"</span>, <span class="st">"D2"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  squares <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  reuse <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35</span>, <span class="fl">40</span>, <span class="fl">38</span>, <span class="fl">41</span><span class="op">)</span>,</span>
<span>  vcomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  sigma2 <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Once the design has been created, <code>pwr.anova</code> and
<code>pwr.contrast</code> can be used to evaluate statistical power as
demonstrated above.</p>
</div>
<div class="section level3">
<h3 id="example-4-split-plot-design">Example 4: Split-plot Design<a class="anchor" aria-label="anchor" href="#example-4-split-plot-design"></a>
</h3>
<p>In this example, we create an SPD with two treatment factors, one at
the main plot level and another at the subplot level. The design
parameters are as follows:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Treatments:</strong></p>
<ul>
<li><p><strong>Main plot factor</strong> with <strong>2
levels</strong></p></li>
<li><p><strong>Subplot factor</strong> with <strong>3
levels</strong></p></li>
</ul>
</li>
<li>
<p><strong>Replicates</strong>:</p>
<ul>
<li><p>Each main plot treatment has <strong>5 plots</strong>, for a
total of <strong>10 plots</strong>.</p></li>
<li><p>This is a standard SPD, where the plots are the blocks at the
subplot level and the subplot design follows an RCBD structure.</p></li>
</ul>
</li>
<li><p><strong>Expected cell means</strong> are:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>t</mi><mi>r</mi><mi>t</mi><mi>.</mi><mi>s</mi><mi>u</mi><mi>b</mi><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>t</mi><mi>r</mi><mi>t</mi><mi>.</mi><mi>s</mi><mi>u</mi><mi>b</mi><mn>2</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>t</mi><mi>r</mi><mi>t</mi><mi>.</mi><mi>s</mi><mi>u</mi><mi>b</mi><mn>3</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>t</mi><mi>r</mi><mi>t</mi><mi>.</mi><mi>m</mi><mi>a</mi><mi>i</mi><mi>n</mi><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>20</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>22</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>24</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>t</mi><mi>r</mi><mi>t</mi><mi>.</mi><mi>m</mi><mi>a</mi><mi>i</mi><mi>n</mi><mn>2</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>22</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>24</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>28</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">
    \begin{array}{c|c|c}
      &amp; trt.sub1 &amp; trt.sub2 &amp; trt.sub3 \\
    \hline
    trt.main1 &amp; 20 &amp; 22 &amp; 24\\
    trt.main2 &amp; 22 &amp; 24 &amp; 28 \\
    \end{array}
    </annotation></semantics></math></p></li>
<li>
<p><strong>Variance Components</strong>:</p>
<ul>
<li><p><strong>Main-plot error</strong>: <code>4</code></p></li>
<li><p><strong>Subplot (residual) error</strong>:
<code>11</code></p></li>
<li><p><strong>Total variance</strong>: <code>15</code></p></li>
</ul>
</li>
</ol>
<p><strong>Generate input templates</strong></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_designs.html">designSPD</a></span><span class="op">(</span></span>
<span>  trt.main <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  trt.sub <span class="op">=</span> <span class="fl">3</span>, </span>
<span>  replicates <span class="op">=</span> <span class="fl">10</span>, </span>
<span>  template <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $fixeff</span></span>
<span><span class="co">#&gt; $fixeff$beta</span></span>
<span><span class="co">#&gt;        (Intercept)          trt.main2           trt.sub2           trt.sub3 </span></span>
<span><span class="co">#&gt;                  1                  2                  3                  4 </span></span>
<span><span class="co">#&gt; trt.main2:trt.sub2 trt.main2:trt.sub3 </span></span>
<span><span class="co">#&gt;                  5                  6 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fixeff$means</span></span>
<span><span class="co">#&gt; trt.main1:trt.sub1 trt.main2:trt.sub1 trt.main1:trt.sub2 trt.main2:trt.sub2 </span></span>
<span><span class="co">#&gt;                  1                  2                  3                  4 </span></span>
<span><span class="co">#&gt; trt.main1:trt.sub3 trt.main2:trt.sub3 </span></span>
<span><span class="co">#&gt;                  5                  6 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $varcov</span></span>
<span><span class="co">#&gt; $varcov$mainplot</span></span>
<span><span class="co">#&gt;             (Intercept)</span></span>
<span><span class="co">#&gt; (Intercept)           1</span></span></code></pre></div>
<p><strong>Create the SPD</strong></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_designs.html">designSPD</a></span><span class="op">(</span></span>
<span>  trt.main <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  trt.sub <span class="op">=</span> <span class="fl">3</span>, </span>
<span>  replicates <span class="op">=</span> <span class="fl">10</span>, </span>
<span>  means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">22</span>, <span class="fl">22</span>, <span class="fl">24</span>, <span class="fl">24</span>, <span class="fl">28</span><span class="op">)</span>,</span>
<span>  vcomp <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  sigma2 <span class="op">=</span> <span class="fl">11</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>One can verify that different values of <strong>main-plot error
(<code>vcomp</code>)</strong> affect the power of the <strong>main plot
factor</strong>, unlike in <em>Example 3</em>, where variance components
did not influence power.</p>
</div>
<div class="section level3">
<h3 id="example-5-repeated-measures">Example 5: Repeated measures<a class="anchor" aria-label="anchor" href="#example-5-repeated-measures"></a>
</h3>
<p>This example illustrates a <strong>repeated measures design,</strong>
where <strong>three treatments</strong> (<code>CON</code>,
<code>TRT1</code>, <code>TRT2</code>) are measured <strong>hourly over 8
hours</strong>. <strong>Within-subject correlations</strong> are modeled
using an <strong>AR(1) structure</strong> with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0.6</mn></mrow><annotation encoding="application/x-tex">\rho = 0.6</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\sigma^2 = 2</annotation></semantics></math>.</p>
<p><strong>Design Details</strong></p>
<p>1. <strong>Subjects</strong>: 6 per treatment group (total: 18
subjects).<br>
2. <strong>Treatments</strong>: <code>CON</code>, <code>TRT1</code>, and
<code>TRT2</code>.<br>
3. <strong>Time Points</strong>: 8 hourly measurements.</p>
<p>4.
<strong>Means</strong>:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="bold">𝐓𝐫𝐞𝐚𝐭𝐦𝐞𝐧𝐭</mtext></mtd><mtd columnalign="center" style="text-align: center"><mtext mathvariant="bold">𝟏</mtext></mtd><mtd columnalign="center" style="text-align: center"><mtext mathvariant="bold">𝟐</mtext></mtd><mtd columnalign="center" style="text-align: center"><mtext mathvariant="bold">𝟑</mtext></mtd><mtd columnalign="center" style="text-align: center"><mtext mathvariant="bold">𝟒</mtext></mtd><mtd columnalign="center" style="text-align: center"><mtext mathvariant="bold">𝟓</mtext></mtd><mtd columnalign="center" style="text-align: center"><mtext mathvariant="bold">𝟔</mtext></mtd><mtd columnalign="center" style="text-align: center"><mtext mathvariant="bold">𝟕</mtext></mtd><mtd columnalign="center" style="text-align: center"><mtext mathvariant="bold">𝟖</mtext></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">CON</mtext></mtd><mtd columnalign="center" style="text-align: center"><mn>1.00</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1.00</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1.00</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1.00</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1.00</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1.00</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1.00</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1.00</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">TRT1</mtext></mtd><mtd columnalign="center" style="text-align: center"><mn>2.50</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>3.50</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>3.98</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>4.03</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>3.68</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>3.35</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>3.02</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>2.94</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">TRT2</mtext></mtd><mtd columnalign="center" style="text-align: center"><mn>3.50</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>4.54</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>5.80</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>5.84</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>5.49</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>4.71</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>4.08</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>3.78</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{c|cccccccc}
\textbf{Treatment} &amp; \textbf{1} &amp; \textbf{2} &amp; \textbf{3} &amp; \textbf{4} &amp; \textbf{5} &amp; \textbf{6} &amp; \textbf{7} &amp; \textbf{8} \\
\hline
\text{CON} &amp; 1.00 &amp; 1.00 &amp; 1.00 &amp; 1.00 &amp; 1.00 &amp; 1.00 &amp; 1.00 &amp; 1.00 \\
\text{TRT1} &amp; 2.50 &amp; 3.50 &amp; 3.98 &amp; 4.03 &amp; 3.68 &amp; 3.35 &amp; 3.02 &amp; 2.94 \\
\text{TRT2} &amp; 3.50 &amp; 4.54 &amp; 5.80 &amp; 5.84 &amp; 5.49 &amp; 4.71 &amp; 4.08 &amp; 3.78 \\
\end{array}
</annotation></semantics></math></p>
<p><strong>Step 1: Creating the design</strong></p>
<p><strong>Create a data frame for the design</strong></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_subject</span> <span class="op">=</span> <span class="fl">6</span> <span class="co"># Subjects per treatment</span></span>
<span><span class="va">n_trt</span> <span class="op">=</span> <span class="fl">3</span> <span class="co"># Number of treatments</span></span>
<span><span class="va">n_hour</span> <span class="op">=</span> <span class="fl">8</span> <span class="co"># Number of repeated measures (time points)</span></span>
<span><span class="va">trt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CON"</span>, <span class="st">"TRT1"</span>, <span class="st">"TRT2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df.rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  subject <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_trt</span><span class="op">*</span><span class="va">n_subject</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n_hour</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  hour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_hour</span><span class="op">)</span>, <span class="va">n_subject</span><span class="op">*</span><span class="va">n_trt</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">trt</span>, each <span class="op">=</span> <span class="va">n_subject</span><span class="op">*</span><span class="va">n_hour</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Input templates</strong></p>
<p>Either values of <code>beta</code> or <code>means</code> are required
in the following order:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mkdesign.html">mkdesign</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="op">~</span> <span class="va">trt</span><span class="op">*</span><span class="va">hour</span>, data <span class="op">=</span> <span class="va">df.rep</span><span class="op">)</span></span>
<span><span class="co">#&gt; $fixeff</span></span>
<span><span class="co">#&gt; $fixeff$beta</span></span>
<span><span class="co">#&gt;   (Intercept)       trtTRT1       trtTRT2         hour2         hour3 </span></span>
<span><span class="co">#&gt;             1             2             3             4             5 </span></span>
<span><span class="co">#&gt;         hour4         hour5         hour6         hour7         hour8 </span></span>
<span><span class="co">#&gt;             6             7             8             9            10 </span></span>
<span><span class="co">#&gt; trtTRT1:hour2 trtTRT2:hour2 trtTRT1:hour3 trtTRT2:hour3 trtTRT1:hour4 </span></span>
<span><span class="co">#&gt;            11            12            13            14            15 </span></span>
<span><span class="co">#&gt; trtTRT2:hour4 trtTRT1:hour5 trtTRT2:hour5 trtTRT1:hour6 trtTRT2:hour6 </span></span>
<span><span class="co">#&gt;            16            17            18            19            20 </span></span>
<span><span class="co">#&gt; trtTRT1:hour7 trtTRT2:hour7 trtTRT1:hour8 trtTRT2:hour8 </span></span>
<span><span class="co">#&gt;            21            22            23            24 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fixeff$means</span></span>
<span><span class="co">#&gt;  trtCON:hour1 trtTRT1:hour1 trtTRT2:hour1  trtCON:hour2 trtTRT1:hour2 </span></span>
<span><span class="co">#&gt;             1             2             3             4             5 </span></span>
<span><span class="co">#&gt; trtTRT2:hour2  trtCON:hour3 trtTRT1:hour3 trtTRT2:hour3  trtCON:hour4 </span></span>
<span><span class="co">#&gt;             6             7             8             9            10 </span></span>
<span><span class="co">#&gt; trtTRT1:hour4 trtTRT2:hour4  trtCON:hour5 trtTRT1:hour5 trtTRT2:hour5 </span></span>
<span><span class="co">#&gt;            11            12            13            14            15 </span></span>
<span><span class="co">#&gt;  trtCON:hour6 trtTRT1:hour6 trtTRT2:hour6  trtCON:hour7 trtTRT1:hour7 </span></span>
<span><span class="co">#&gt;            16            17            18            19            20 </span></span>
<span><span class="co">#&gt; trtTRT2:hour7  trtCON:hour8 trtTRT1:hour8 trtTRT2:hour8 </span></span>
<span><span class="co">#&gt;            21            22            23            24 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $varcov</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p><strong>Create the design</strong></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design.rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mkdesign.html">mkdesign</a></span><span class="op">(</span></span>
<span>formula <span class="op">=</span> <span class="op">~</span> <span class="va">trt</span><span class="op">*</span><span class="va">hour</span>,</span>
<span>data <span class="op">=</span> <span class="va">df.rep</span>,</span>
<span>means <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2.50</span>, <span class="fl">3.5</span>,</span>
<span>           <span class="fl">1</span>, <span class="fl">3.50</span>, <span class="fl">4.54</span>,</span>
<span>           <span class="fl">1</span>, <span class="fl">3.98</span>, <span class="fl">5.80</span>,</span>
<span>           <span class="fl">1</span>, <span class="fl">4.03</span>, <span class="fl">5.4</span>,</span>
<span>           <span class="fl">1</span>, <span class="fl">3.68</span>, <span class="fl">5.49</span>,</span>
<span>           <span class="fl">1</span>, <span class="fl">3.35</span>, <span class="fl">4.71</span>,</span>
<span>           <span class="fl">1</span>, <span class="fl">3.02</span>, <span class="fl">4.08</span>,</span>
<span>           <span class="fl">1</span>, <span class="fl">2.94</span>, <span class="fl">3.78</span><span class="op">)</span>,</span>
<span>sigma2 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>correlation <span class="op">=</span> <span class="fu">corAR1</span><span class="op">(</span>value <span class="op">=</span> <span class="fl">0.6</span>, form <span class="op">=</span> <span class="op">~</span> <span class="va">hour</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Step 2: Power calculation</strong></p>
<p>Statistical power for main effects of treatment and time, and their
interaction:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.anova.html">pwr.anova</a></span><span class="op">(</span><span class="va">design.rep</span><span class="op">)</span></span>
<span><span class="co">#&gt; Power of type III F-test</span></span>
<span><span class="co">#&gt;          NumDF  DenDF sig.level   power</span></span>
<span><span class="co">#&gt; trt          2 21.563      0.05 1.00000</span></span>
<span><span class="co">#&gt; hour         7 86.055      0.05 0.74687</span></span>
<span><span class="co">#&gt; trt:hour    14 86.055      0.05 0.38500</span></span></code></pre></div>
<p>Statistical power for treatment differences at each time point:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span><span class="va">design.rep</span>, which <span class="op">=</span> <span class="st">"trt"</span>, by <span class="op">=</span> <span class="st">"hour"</span>, contrast <span class="op">=</span> <span class="st">"trt.vs.ctrl"</span>, p.adj <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt; $`hour = 1`</span></span>
<span><span class="co">#&gt;                  effect       df sig.level     power alternative</span></span>
<span><span class="co">#&gt; trtTRT1 - trtCON    1.5 64.41176     0.025 0.3299823   two.sided</span></span>
<span><span class="co">#&gt; trtTRT2 - trtCON    2.5 64.41176     0.025 0.7765112   two.sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`hour = 2`</span></span>
<span><span class="co">#&gt;                  effect       df sig.level     power alternative</span></span>
<span><span class="co">#&gt; trtTRT1 - trtCON   2.50 64.41176     0.025 0.7765112   two.sided</span></span>
<span><span class="co">#&gt; trtTRT2 - trtCON   3.54 64.41176     0.025 0.9777118   two.sided</span></span></code></pre></div>
<p>As shown in <em>Example 5</em>, any design can be created using the
<code>mkdesign</code> function as long as the appropriate data frame is
provided. However, the package currently does not support non-normal
response variables.</p>
</div>
</div>
<div class="section level2">
<h2 id="fundamental-concepts">Fundamental concepts<a class="anchor" aria-label="anchor" href="#fundamental-concepts"></a>
</h2>
<p><code>pwr4exp</code> is developed based on LMM theory. The general
form of an LMM can be expressed as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>X</mi><mi>β</mi><mo>+</mo><mi>Z</mi><mi>u</mi><mo>+</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex">
y = X\beta + Zu + \varepsilon
</annotation></semantics></math></p>
<p>where:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
represents the observations of the response variable,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
represents the fixed effect coefficients,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>
denotes the random effects, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>∼</mo><msub><mi>N</mi><mi>q</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>G</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">u \sim N_q(0, G)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ε</mi><annotation encoding="application/x-tex">\varepsilon</annotation></semantics></math>
represents the random errors, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ε</mi><mo>∼</mo><msub><mi>N</mi><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>R</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\varepsilon \sim N_n(0, R)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>×</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><annotation encoding="application/x-tex">X_{(n \times p)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>×</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><annotation encoding="application/x-tex">Z_{(n \times q)}</annotation></semantics></math>
are the design matrices for the fixed and random effects,
respectively.</p>
<p>It is assumed that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ε</mi><annotation encoding="application/x-tex">\varepsilon</annotation></semantics></math>
are independent, and the marginal distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
follows a normal distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>∼</mo><msub><mi>N</mi><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mi>β</mi><mo>,</mo><mi>V</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y \sim N_n(X\beta, V)</annotation></semantics></math>,
where:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>=</mo><mi>Z</mi><mi>G</mi><msup><mi>Z</mi><mi>T</mi></msup><mo>+</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">
V = ZGZ^T + R
</annotation></semantics></math></p>
<div class="section level3">
<h3 id="inference-on-treatment-effects">Inference on Treatment Effects<a class="anchor" aria-label="anchor" href="#inference-on-treatment-effects"></a>
</h3>
<p>Inference on treatment effects often involves testing omnibus
hypotheses and contrasts. These can be formulated using the general
linear hypothesis:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>K</mi><mi>β</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">
H_0: K\beta = 0
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
is a contrast matrix. When the variance-covariance parameters in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
are known, the estimate of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>β</mi><mo accent="true">̂</mo></mover><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>X</mi><mi>T</mi></msup><msup><mi>V</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mi>T</mi></msup><msup><mi>V</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>y</mi></mrow><annotation encoding="application/x-tex">
\hat{\beta} = (X^TV^{-1}X)^{-1}X^TV^{-1}y
</annotation></semantics></math></p>
<p>And its variance is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>X</mi><mi>T</mi></msup><msup><mi>V</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">
C = (X^TV^{-1}X)^{-1}
</annotation></semantics></math></p>
<p>The sampling distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>′</mi><mover><mi>β</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">K'\hat{\beta}</annotation></semantics></math>
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>′</mi><mover><mi>β</mi><mo accent="true">̂</mo></mover><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>K</mi><mi>′</mi><mi>C</mi><mi>K</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
K'\hat{\beta} \sim N(0, K'CK)
</annotation></semantics></math></p>
<p>However, in practical situations, the matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
are unknown and must be estimated using methods like Maximum Likelihood
(ML) or Restricted ML (REML). The estimate of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
is obtained by plugging in the estimated covariance matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>V</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{V}</annotation></semantics></math>,
where:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>V</mi><mo accent="true">̂</mo></mover><mo>=</mo><mi>Z</mi><mover><mi>G</mi><mo accent="true">̂</mo></mover><msup><mi>Z</mi><mi>T</mi></msup><mo>+</mo><mover><mi>R</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">
\hat{V} = Z\hat{G}Z^T + \hat{R}
</annotation></semantics></math></p>
<p>The resulting estimate of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>β</mi><mo accent="true">̂</mo></mover><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>X</mi><mi>T</mi></msup><msup><mover><mi>V</mi><mo accent="true">̂</mo></mover><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mi>T</mi></msup><msup><mover><mi>V</mi><mo accent="true">̂</mo></mover><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>y</mi></mrow><annotation encoding="application/x-tex">
\hat{\beta} = (X^T\hat{V}^{-1}X)^{-1}X^T\hat{V}^{-1}y
</annotation></semantics></math></p>
<p>And its estimated variance is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>C</mi><mo accent="true">̂</mo></mover><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>X</mi><mi>T</mi></msup><msup><mover><mi>V</mi><mo accent="true">̂</mo></mover><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">
\hat{C} = (X^T\hat{V}^{-1}X)^{-1}
</annotation></semantics></math></p>
<p>When testing the null hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>K</mi><mi>β</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0: K\beta = 0</annotation></semantics></math>,
an approximate F-statistic is used. The F-statistic is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mfrac><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mover><mi>β</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><msup><mrow><mo stretchy="true" form="prefix">[</mo><mi>K</mi><mover><mi>C</mi><mo accent="true">̂</mo></mover><msup><mi>K</mi><mi>T</mi></msup><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mover><mi>β</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msub><mi>v</mi><mn>1</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">
F = \frac{(K\hat{\beta})^T [K\hat{C}K^T]^{-1} (K\hat{\beta})}{v_1}
</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
follows an approximate F-distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>v</mi><mn>1</mn></msub><mo>,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(v_1, v_2)</annotation></semantics></math>
under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>=</mo><mtext mathvariant="normal">rank</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">v_1 = \text{rank}(K) \geq 1</annotation></semantics></math>
represents the numerator degrees of freedom (df),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mn>2</mn></msub><annotation encoding="application/x-tex">v_2</annotation></semantics></math>
is the denominator df.</p>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">rank</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{rank}(K) = 1</annotation></semantics></math>,
the F-statistic simplifies to the square of the t-statistic:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">
F = t^2
</annotation></semantics></math>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mfrac><mrow><mi>k</mi><mi>′</mi><mover><mi>β</mi><mo accent="true">̂</mo></mover></mrow><msqrt><mrow><mi>k</mi><mi>′</mi><mover><mi>C</mi><mo accent="true">̂</mo></mover><mi>K</mi></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">t = \frac{k'\hat{\beta}}{\sqrt{k'\hat{C}K}}</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mn>2</mn></msub><annotation encoding="application/x-tex">v_2</annotation></semantics></math>
df.</p>
<p>In balanced designs, where data is analyzed using a variance
components model, commonly applied in experimental animal research,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mn>2</mn></msub><annotation encoding="application/x-tex">v_2</annotation></semantics></math>​
can be precisely determined through degrees of freedom decomposition, as
applied in analysis of variance (ANOVA).</p>
<p>However, for more general cases,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mn>2</mn></msub><annotation encoding="application/x-tex">v_2</annotation></semantics></math>
must be approximated using methods.</p>
<p>The Satterthwaite approximation (Satterthwaite, 1946) for DF in
t-tests can be calculated as outlined by Giesbrecht and Burns
(1985):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>2</mn></msub><mo>=</mo><mfrac><mrow><mn>2</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>k</mi><mi>T</mi></msup><mover><mi>C</mi><mo accent="true">̂</mo></mover><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><mrow><msup><mi>g</mi><mi>T</mi></msup><mi>A</mi><mi>g</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
v_2 = \frac{2(k^T \hat{C} k)^2}{g^T A g}
</annotation></semantics></math></p>
<p>where:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
is the gradient of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>k</mi><mi>T</mi></msup><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k^T C(\hat{\theta}) k</annotation></semantics></math>
with respect to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>,
the variance-covariance parameters in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>,
evaluated at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>θ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\theta}</annotation></semantics></math>.
Matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
is the asymptotic variance-covariance matrix of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>θ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\theta}</annotation></semantics></math>,
obtained from the information matrix of ML or REML estimation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>θ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\theta}</annotation></semantics></math>
(Stroup, 2012).</p>
<p>In F-tests,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mn>2</mn></msub><annotation encoding="application/x-tex">v_2</annotation></semantics></math>
can be calculated by following the procedures described by Fai and
Cornelius (1996). First,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>C</mi><msup><mover><mi>K</mi><mo accent="true">̂</mo></mover><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">KC\hat{K}^T</annotation></semantics></math>
is decomposed to yield
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>C</mi><msup><mover><mi>K</mi><mo accent="true">̂</mo></mover><mi>T</mi></msup><mo>=</mo><msup><mi>P</mi><mi>T</mi></msup><mi>D</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">KC\hat{K}^T = P^T D P</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
is an orthogonal matrix of eigen vectors, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
is a diagonal matrix of eigenvalues. Define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>m</mi></msub><mi>C</mi><msubsup><mi>k</mi><mi>m</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">k_m Ck_m^T</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mi>m</mi></msub><annotation encoding="application/x-tex">k_m</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>-th
row of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>K</mi></mrow><annotation encoding="application/x-tex">P K</annotation></semantics></math>,
and let:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>m</mi></msub><mo>=</mo><mfrac><mrow><mn>2</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><mrow><msubsup><mi>g</mi><mi>m</mi><mi>T</mi></msubsup><mi>A</mi><msub><mi>g</mi><mi>m</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
v_m = \frac{2(D_m)^2}{g_m^T A g_m}
</annotation></semantics></math></p>
<p>where:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>m</mi></msub><annotation encoding="application/x-tex">D_m</annotation></semantics></math>is
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>th
diagonal element of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mi>m</mi></msub><annotation encoding="application/x-tex">g_m</annotation></semantics></math>
is the gradient of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>m</mi></msub><mi>C</mi><msubsup><mi>k</mi><mi>m</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">k_m C k_m^T</annotation></semantics></math>
with respect to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>,
evaluated at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>θ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\theta}</annotation></semantics></math>.</p>
<p>Then let:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>v</mi><mn>1</mn></msub></munderover><mfrac><msub><mi>v</mi><mi>m</mi></msub><mrow><msub><mi>v</mi><mi>m</mi></msub><mo>−</mo><mn>2</mn></mrow></mfrac><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>v</mi><mi>m</mi></msub><mo>&gt;</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
E = \sum_{m=1}^{v_1} \frac{v_m}{v_m - 2} I(v_m &gt; 2)
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>v</mi><mi>m</mi></msub><mo>&gt;</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I(v_m &gt; 2)</annotation></semantics></math>
denotes the indicator function. The denominator DF
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mn>2</mn></msub><annotation encoding="application/x-tex">v_2</annotation></semantics></math>
is calculated as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>2</mn></msub><mo>=</mo><mfrac><mrow><mn>2</mn><mi>E</mi></mrow><mrow><mi>E</mi><mo>−</mo><msub><mi>v</mi><mn>1</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
v_2 = \frac{2E}{E - v_1}
</annotation></semantics></math> The Satterthwaite approximation can be
applied in power analysis by plugging in the assumed values of variance
parameters (Stroup, 2002).</p>
</div>
<div class="section level3">
<h3 id="power-calculation-under-the-alternative-hypothesis">Power Calculation Under the Alternative Hypothesis<a class="anchor" aria-label="anchor" href="#power-calculation-under-the-alternative-hypothesis"></a>
</h3>
<p>Under the alternative hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><mi>K</mi><mi>′</mi><mi>β</mi><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_A: K'\beta \neq 0</annotation></semantics></math>,
the F-statistic follows a non-central distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>v</mi><mn>1</mn></msub><mo>,</mo><msub><mi>v</mi><mn>2</mn></msub><mo>,</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(v_1, v_2, \phi)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
is the non-centrality parameter that measures the departure from the
null hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>.
The non-centrality parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mover><mi>β</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><msup><mrow><mo stretchy="true" form="prefix">[</mo><mi>K</mi><mover><mi>C</mi><mo accent="true">̂</mo></mover><msup><mi>K</mi><mi>T</mi></msup><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mover><mi>β</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\phi = (K\hat{\beta})^T [K\hat{C}K^T]^{-1} (K\hat{\beta})
</annotation></semantics></math></p>
<p>Once the distribution of the F-statistic under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>A</mi></msub><annotation encoding="application/x-tex">H_A</annotation></semantics></math>
is known, the power of the test can be calculated as the conditional
probability of rejecting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>A</mi></msub><annotation encoding="application/x-tex">H_A</annotation></semantics></math>
is true:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Power</mtext><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mtext mathvariant="normal">reject </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>F</mi><mo>&gt;</mo><msub><mi>F</mi><mtext mathvariant="normal">crit</mtext></msub><mo>∣</mo><msub><mi>H</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\text{Power} = P(\text{reject } H_0: F &gt; F_{\text{crit}} \mid H_A)
</annotation></semantics></math></p>
<p>Where:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mtext mathvariant="normal">crit</mtext></msub><annotation encoding="application/x-tex">F_{\text{crit}}</annotation></semantics></math>
is the critical value of the F-statistic used to reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>,
determined such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>F</mi><mo>&gt;</mo><msub><mi>F</mi><mtext mathvariant="normal">crit</mtext></msub><mo>∣</mo><msub><mi>H</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">P(F &gt; F_{\text{crit}} \mid H_0) = \alpha</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
is the type I error rate.</p>
<p>The determination of the degrees of freedom
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mn>1</mn></msub><annotation encoding="application/x-tex">v_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mn>2</mn></msub><annotation encoding="application/x-tex">v_2</annotation></semantics></math>,
as well as the non-centrality parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>,
are critical steps for power calculation.</p>
<p>Generally, power analysis requires specifying the following
components:</p>
<ul>
<li>The <strong>Design</strong> to be evaluated, which determines the
matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
(fixed effects) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
(random effects).</li>
<li>The <strong>Treatment Effects</strong>, which determine
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
(the fixed effect coefficients).</li>
<li>The <strong>Variance Components</strong>, which determine
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
(the covariance matrix of the random effects) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
(the covariance matrix of the residuals).</li>
</ul>
<p>A key aspect of conducting a valid power analysis is obtaining
<strong>reasonable estimates for the magnitude of the
parameters</strong> that will be used in the model. This includes:</p>
<ul>
<li>
<strong>Treatment Effects</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>):
The size of the treatment effect(s) you expect to detect. This can be
obtained from previous studies, pilot experiments, or subject-matter
expertise.</li>
<li>
<strong>Variance Components</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>):
These represent the variability in the random effects and residual
errors. Variance estimates are often obtained from:
<ul>
<li>
<strong>Pilot studies</strong> or preliminary data, which can
provide initial estimates of variability in random effects (e.g.,
subject-to-subject variability or group-level variability).</li>
<li>
<strong>Literature</strong> on similar experiments, where variance
components have been reported.</li>
<li>
<strong>Subject-matter expertise</strong>, where researchers provide
estimates based on their knowledge of the system being studied.</li>
</ul>
</li>
</ul>
<p>Performing a power analysis with unrealistic parameter magnitudes can
lead to incorrect conclusions, either overestimating the likelihood of
detecting a treatment effect or requiring an unnecessarily large sample
size.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Fai, A. H., &amp; Cornelius, P. L. (1996). Approximate F-tests of
multiple degree of freedom hypotheses in generalized least squares
analyses of unbalanced split-plot experiments. <em>Journal of
Statistical Computation and Simulation, 54</em>(4), 363–378.</p>
<p>Giesbrecht, F. G., &amp; Burns, J. C. (1985). Two-stage analysis
based on a mixed model: Large-sample asymptotic theory and small-sample
simulation results. <em>Biometrics, 41</em>(2), 477–486.</p>
<p>Satterthwaite, F. E. (1946). An approximate distribution of estimates
of variance components. <em>Biometrics Bulletin, 2</em>(6), 110–114.</p>
<p>Stroup, W. W. (2002). Power analysis based on spatial effects mixed
models: A tool for comparing design and analysis strategies in the
presence of spatial variability. <em>Journal of Agricultural,
Biological, and Environmental Statistics, 7</em>(4), 491–511.</p>
<p>Stroup, W. W. (2012). <em>Generalized linear mixed models: Modern
concepts, methods, and applications</em> (1st ed.). CRC Press.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kai Wang, Mutian Niu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
