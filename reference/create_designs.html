<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Creation of Standard Experimental Designs — designCRD • pwr4exp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creation of Standard Experimental Designs — designCRD"><meta name="description" content="These functions facilitate the creation of standard experimental designs
commonly used in agricultural studies for power analysis. Unlike mkdesign
which requires a pre-existing data frame, these functions allow users to
directly specify key design characteristics to generate experimental layouts.
Quantitative parameters describing fixed and random effects remain consistent
with those in mkdesign."><meta property="og:description" content="These functions facilitate the creation of standard experimental designs
commonly used in agricultural studies for power analysis. Unlike mkdesign
which requires a pre-existing data frame, these functions allow users to
directly specify key design characteristics to generate experimental layouts.
Quantitative parameters describing fixed and random effects remain consistent
with those in mkdesign."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pwr4exp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pwr4exp.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/an-ethz/pwr4exp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Creation of Standard Experimental Designs</h1>
      <small class="dont-index">Source: <a href="https://github.com/an-ethz/pwr4exp/blob/main/R/standard_designs.R" class="external-link"><code>R/standard_designs.R</code></a></small>
      <div class="d-none name"><code>create_designs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions facilitate the creation of standard experimental designs
commonly used in agricultural studies for power analysis. Unlike <a href="mkdesign.html">mkdesign</a>
which requires a pre-existing data frame, these functions allow users to
directly specify key design characteristics to generate experimental layouts.
Quantitative parameters describing fixed and random effects remain consistent
with those in <a href="mkdesign.html">mkdesign</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">designCRD</span><span class="op">(</span></span>
<span>  <span class="va">treatments</span>,</span>
<span>  <span class="va">label</span>,</span>
<span>  <span class="va">replicates</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  means <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">sigma2</span>,</span>
<span>  template <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">designRCBD</span><span class="op">(</span></span>
<span>  <span class="va">treatments</span>,</span>
<span>  <span class="va">label</span>,</span>
<span>  <span class="va">blocks</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  means <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">vcomp</span>,</span>
<span>  <span class="va">sigma2</span>,</span>
<span>  template <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">designLSD</span><span class="op">(</span></span>
<span>  <span class="va">treatments</span>,</span>
<span>  <span class="va">label</span>,</span>
<span>  squares <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  reuse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"col"</span>, <span class="st">"both"</span><span class="op">)</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  means <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">vcomp</span>,</span>
<span>  <span class="va">sigma2</span>,</span>
<span>  template <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">designCOD</span><span class="op">(</span></span>
<span>  <span class="va">treatments</span>,</span>
<span>  <span class="va">label</span>,</span>
<span>  squares <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  means <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">vcomp</span>,</span>
<span>  <span class="va">sigma2</span>,</span>
<span>  template <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">designSPD</span><span class="op">(</span></span>
<span>  <span class="va">trt.main</span>,</span>
<span>  <span class="va">trt.sub</span>,</span>
<span>  <span class="va">label</span>,</span>
<span>  <span class="va">replicates</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  means <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">vcomp</span>,</span>
<span>  <span class="va">sigma2</span>,</span>
<span>  template <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-treatments">treatments<a class="anchor" aria-label="anchor" href="#arg-treatments"></a></dt>
<dd><p>An integer vector where each element represents the number of levels
of the corresponding treatment factor. A single integer (e.g., <code>treatments = n</code>)
specifies one treatment factor with <code>n</code> levels. When multiple factors are provided,
they are arranged in a factorial treatment factor design. For example,
<code>treatments = c(2, 3)</code> creates a 2x3 factorial design with the first factor having 2 levels
and the second factor having 3 levels.</p></dd>


<dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>Optional. A list of character vectors, each corresponding to a treatment factor.
The name of each vector specifies the factor's name, and its elements provide the labels for that factor's levels.
If no labels are provided, default labels will be used. For a single treatment factor, the default is
<code>list(trt = c("1", "2", ...))</code>, and for two treatment factors, the default is
<code>list(facA = c("1", "2", ...), facB = c("1", "2", ...))</code>.
For split-plot designs, the defaults are similar but include the ".main" and ".sub" suffixes for main plot and subplot factors.
For example:
<code>list(trt.main = c("1", "2", ...), trt.sub = c("1", "2", ...))</code> and
<code>list(facA.main = c("1", "2", ...), facB.main = c("1", "2", ...),
      facA.sub = c("1", "2", ...), facB.sub = c("1", "2", ...))</code>.
Label sets should be arranged so that the main plot factors come first, followed by the subplot factors.</p></dd>


<dt id="arg-replicates">replicates<a class="anchor" aria-label="anchor" href="#arg-replicates"></a></dt>
<dd><p>The number of experimental units per treatment in a completely
randomized design or the number of experimental units (main plots) per treatment
of main plot factors.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A right-hand-side <a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a> specifying the model for testing treatment effects,
with terms on the right of <a href="https://rdrr.io/r/base/tilde.html" class="external-link">~</a> , following lme4::lmer syntax for random effects.
If not specified, a default formula with main effects and all interactions is used internally.</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>One of the optional inputs for fixed effects.
A vector of model coefficients where factor variable coefficients correspond
to dummy variables created using treatment contrast (stats::contr.treatment).</p></dd>


<dt id="arg-means">means<a class="anchor" aria-label="anchor" href="#arg-means"></a></dt>
<dd><p>One of the optional inputs for fixed effects.
A vector of marginal or conditioned means (if factors have interactions).
Regression coefficients are required for numerical variables.
Either <code>beta</code> or <code>means</code> must be provided, and their values must strictly follow a specific order.
A template can be created to indicate the required input values and their order.
See <a href="mkdesign.html">mkdesign</a> for more information.</p></dd>


<dt id="arg-sigma-">sigma2<a class="anchor" aria-label="anchor" href="#arg-sigma-"></a></dt>
<dd><p>error variance.</p></dd>


<dt id="arg-template">template<a class="anchor" aria-label="anchor" href="#arg-template"></a></dt>
<dd><p>Default is <code>FALSE</code>.
If <code>TRUE</code>, a template for <code>beta</code>, <code>means</code>, and <code>vcomp</code> is generated to indicate the required input order.</p></dd>


<dt id="arg-reml">REML<a class="anchor" aria-label="anchor" href="#arg-reml"></a></dt>
<dd><p>Specifies whether to use REML or ML information matrix. Default is <code>TRUE</code> (REML).</p></dd>


<dt id="arg-blocks">blocks<a class="anchor" aria-label="anchor" href="#arg-blocks"></a></dt>
<dd><p>The number of blocks.</p></dd>


<dt id="arg-vcomp">vcomp<a class="anchor" aria-label="anchor" href="#arg-vcomp"></a></dt>
<dd><p>A vector of variance-covariance components for random effects, if present.
The values must follow a strict order. See <a href="mkdesign.html">mkdesign</a>.</p></dd>


<dt id="arg-squares">squares<a class="anchor" aria-label="anchor" href="#arg-squares"></a></dt>
<dd><p>The number of replicated squares. By default, 1, i.e., no
replicated squares.</p></dd>


<dt id="arg-reuse">reuse<a class="anchor" aria-label="anchor" href="#arg-reuse"></a></dt>
<dd><p>A character string specifying how to replicate squares when
there are multiple squares. Options are: "row" for reusing row blocks, "col"
for reusing column blocks, or "both" for reusing both row and column blocks
to replicate a single square.</p></dd>


<dt id="arg-trt-main">trt.main<a class="anchor" aria-label="anchor" href="#arg-trt-main"></a></dt>
<dd><p>An integer-valued vector specifying the treatment structure at
main plot level for a split plot design, similar to <code>treatments</code>.</p></dd>


<dt id="arg-trt-sub">trt.sub<a class="anchor" aria-label="anchor" href="#arg-trt-sub"></a></dt>
<dd><p>An integer-valued vector specifying the treatment structure at
sub plot level for a split plot design, similar to <code>treatments</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list object containing all essential components for power calculation.
This includes:</p><ul><li><p>Structural components (deStruct): including the data frame, design matrices
for fixed and random effects, variance-covariance matrices for random effects
and residuals, etc.</p></li>
<li><p>Internally calculated higher-level parameters (deParam), including variance-covariance
matrix of beta coefficients (vcov_beta), variance-covariance matrix of variance parameters (vcov_varpar),
gradient matrices (Jac_list), etc.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Each function creates a standard design as described below:</p><dl><dt><code>designCRD</code></dt>
<dd><p>Completely Randomized Design.
By default, the model formula is <code>~ trt</code> for one factor and
<code>~ facA*facB</code> for two factors, unless explicitly specified. If the
<code>label</code> argument is provided, the formula is automatically updated with the
specified treatment factor names.</p></dd>

<dt><code>designRCBD</code></dt>
<dd><p>Randomized Complete Block Design.
Experimental units are grouped into blocks, with each treatment appearing
<strong>exactly</strong> once per block (i.e., no replicates per treatment within a block).
The default model formula is <code>~ trt + (1|block)</code> for one factor and
<code>~ facA*facB + (1|block)</code> for two factors. If <code>label</code> is provided, the
fixed effect parts of the formula are automatically updated with the specified
names. The block factor is named "block" and not changeable.</p></dd>

<dt><code>designLSD</code></dt>
<dd><p>Latin Square Design.
The default formula is <code>~ trt + (1|row) + (1|col)</code> for one factor and
<code>~ facA*facB + (1|row) + (1|col)</code> for two factors. If <code>label</code> is provided,
the fixed effect parts of the formula are automatically updated with the specified
names. The names of row ("row") and column ("col") block factors are not changeable.</p></dd>

<dt><code>designCOD</code></dt>
<dd><p>Crossover Design, which is a special case of LSD
with time periods and individuals as blocks. Period blocks are reused when
replicating squares.
The default formula is <code>~ trt + (1|subject) + (1|period)</code> for one factor
and <code>~ facA*facB + (1|subject) + (1|period)</code> for two factors. If <code>label</code>
is provided, the fixed effect parts of the formula are automatically updated
with the specified names. Note that "subject" and "period" are the names for
the two blocking factors and cannot be changed.</p></dd>

<dt><code>designSPD</code></dt>
<dd><p>Split Plot Design.
The default formula includes the main effects of all treatment factors at
both the main and sub-plot levels, their interactions, and the random effects
of main plots: <code>~ . + (1|mainplot)</code>. If <code>label</code> is provided, the fixed
effect parts of the formula are automatically updated with the specified names.
The experimental unit at the main plot level (i.e., the block factor at the
subplot level) is always named as "mainplot".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="mkdesign.html">mkdesign</a>, <a href="pwr.anova.html">pwr.anova</a>, <a href="pwr.contrast.html">pwr.contrast</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Evaluate the power of a CRD with one treatment factor</span></span></span>
<span class="r-in"><span><span class="co">## Create a design object</span></span></span>
<span class="r-in"><span><span class="va">crd</span> <span class="op">&lt;-</span> <span class="fu">designCRD</span><span class="op">(</span></span></span>
<span class="r-in"><span>  treatments <span class="op">=</span> <span class="fl">4</span>, <span class="co"># 4 levels of one treatment factor</span></span></span>
<span class="r-in"><span>  replicates <span class="op">=</span> <span class="fl">12</span>, <span class="co"># 12 units per level, 48 units totally</span></span></span>
<span class="r-in"><span>  means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">28</span>, <span class="fl">33</span>, <span class="fl">35</span><span class="op">)</span>, <span class="co"># means of the 4 levels</span></span></span>
<span class="r-in"><span>  sigma2 <span class="op">=</span> <span class="fl">10</span> <span class="co"># error variance</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## power of omnibus test</span></span></span>
<span class="r-in"><span><span class="fu"><a href="pwr.anova.html">pwr.anova</a></span><span class="op">(</span><span class="va">crd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power of type III F-test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     NumDF DenDF sig.level power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trt     3    44      0.05 0.999</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## power of contrast</span></span></span>
<span class="r-in"><span><span class="fu"><a href="pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span><span class="va">crd</span>, which <span class="op">=</span> <span class="st">"trt"</span>, contrast <span class="op">=</span> <span class="st">"pairwise"</span><span class="op">)</span> <span class="co"># pairwise comparisons</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             effect df sig.level     power alternative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trt1 - trt2      2 44      0.05 0.3285822   two.sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trt1 - trt3     -3 44      0.05 0.6228308   two.sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trt1 - trt4     -5 44      0.05 0.9661638   two.sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trt2 - trt3     -5 44      0.05 0.9661638   two.sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trt2 - trt4     -7 44      0.05 0.9995822   two.sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trt3 - trt4     -2 44      0.05 0.3285822   two.sided</span>
<span class="r-in"><span><span class="fu"><a href="pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span><span class="va">crd</span>, which <span class="op">=</span> <span class="st">"trt"</span>, contrast <span class="op">=</span> <span class="st">"poly"</span><span class="op">)</span> <span class="co"># polynomial contrasts</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           effect df sig.level     power alternative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linear        20 44      0.05 0.9976700   two.sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> quadratic      4 44      0.05 0.5726028   two.sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cubic        -10 44      0.05 0.6685119   two.sided</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># More examples are available in `vignette("pwr4exp")`</span></span></span>
<span class="r-in"><span><span class="co"># and on https://an-ethz.github.io/pwr4exp/</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kai Wang, Mutian Niu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

